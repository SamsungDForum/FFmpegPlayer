<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="646px" preserveAspectRatio="none" style="width:469px;height:646px;" version="1.1" viewBox="0 0 469 646" width="469px" zoomAndPan="magnify"><defs><filter height="300%" id="fttk0d3axy14z" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fttk0d3axy14z)" height="121.4063" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="171" y="69.2188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="171" x2="171" y1="69.2188" y2="190.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="181" x2="181" y1="69.2188" y2="190.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="171" x2="181" y1="69.2188" y2="69.2188"/><rect fill="#FFFFFF" filter="url(#fttk0d3axy14z)" height="121.4063" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="171" y="218.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="171" x2="171" y1="218.625" y2="340.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="181" x2="181" y1="218.625" y2="340.0313"/><rect fill="#FFFFFF" filter="url(#fttk0d3axy14z)" height="253.4609" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="171" y="368.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="171" x2="171" y1="368.0313" y2="621.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="181" x2="181" y1="368.0313" y2="621.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="171" x2="181" y1="621.4922" y2="621.4922"/><rect fill="#FFFFFF" filter="url(#fttk0d3axy14z)" height="121.4063" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="395" y="69.2188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395" x2="395" y1="69.2188" y2="190.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="69.2188" y2="190.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395" x2="405" y1="69.2188" y2="69.2188"/><rect fill="#FFFFFF" filter="url(#fttk0d3axy14z)" height="121.4063" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="395" y="218.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395" x2="395" y1="218.625" y2="340.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="218.625" y2="340.0313"/><rect fill="#FFFFFF" filter="url(#fttk0d3axy14z)" height="222.4609" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="395" y="368.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395" x2="395" y1="368.0313" y2="590.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="368.0313" y2="590.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395" x2="405" y1="590.4922" y2="590.4922"/><rect fill="#FFFFFF" filter="url(#fttk0d3axy14z)" height="172.7578" style="stroke: #000000; stroke-width: 2.0;" width="342.5" x="113" y="435.7344"/><rect fill="#FFFFFF" filter="url(#fttk0d3axy14z)" height="122.4063" style="stroke: #000000; stroke-width: 2.0;" width="322.5" x="123" y="461.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="176" x2="176" y1="59.2188" y2="190.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="176" x2="176" y1="190.625" y2="218.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="176" x2="176" y1="218.625" y2="340.0313"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="176" x2="176" y1="340.0313" y2="368.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="176" x2="176" y1="368.0313" y2="639.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="399.5" x2="399.5" y1="59.2188" y2="190.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="399.5" x2="399.5" y1="190.625" y2="218.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="399.5" x2="399.5" y1="218.625" y2="340.0313"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="399.5" x2="399.5" y1="340.0313" y2="368.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="399.5" x2="399.5" y1="368.0313" y2="639.4922"/><rect fill="#FEFECE" filter="url(#fttk0d3axy14z)" height="49.2188" style="stroke: #A80036; stroke-width: 1.5;" width="82" x="133" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="25" x="161.5" y="26.5332">«T»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="68" x="140" y="44.1426">DataBuffer</text><rect fill="#FEFECE" filter="url(#fttk0d3axy14z)" height="49.2188" style="stroke: #A80036; stroke-width: 1.5;" width="67" x="364.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="25" x="385.5" y="26.5332">«T»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="371.5" y="44.1426">Channel</text><rect fill="#FFFFFF" filter="url(#fttk0d3axy14z)" height="121.4063" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="171" y="69.2188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="171" x2="171" y1="69.2188" y2="190.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="181" x2="181" y1="69.2188" y2="190.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="171" x2="181" y1="69.2188" y2="69.2188"/><rect fill="#FFFFFF" filter="url(#fttk0d3axy14z)" height="121.4063" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="171" y="218.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="171" x2="171" y1="218.625" y2="340.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="181" x2="181" y1="218.625" y2="340.0313"/><rect fill="#FFFFFF" filter="url(#fttk0d3axy14z)" height="253.4609" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="171" y="368.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="171" x2="171" y1="368.0313" y2="621.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="181" x2="181" y1="368.0313" y2="621.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="171" x2="181" y1="621.4922" y2="621.4922"/><rect fill="#FFFFFF" filter="url(#fttk0d3axy14z)" height="121.4063" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="395" y="69.2188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395" x2="395" y1="69.2188" y2="190.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="69.2188" y2="190.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395" x2="405" y1="69.2188" y2="69.2188"/><rect fill="#FFFFFF" filter="url(#fttk0d3axy14z)" height="121.4063" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="395" y="218.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395" x2="395" y1="218.625" y2="340.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="218.625" y2="340.0313"/><rect fill="#FFFFFF" filter="url(#fttk0d3axy14z)" height="222.4609" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="395" y="368.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395" x2="395" y1="368.0313" y2="590.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="368.0313" y2="590.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395" x2="405" y1="590.4922" y2="590.4922"/><polygon fill="#A80036" points="159,87.5703,169,91.5703,159,95.5703,163,91.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="0" x2="165" y1="91.5703" y2="91.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="7" y="86.7139">Add( T )</text><polygon fill="#A80036" points="383,117.9219,393,121.9219,383,125.9219,387,121.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="181" x2="389" y1="121.9219" y2="121.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="188" y="117.0654">TryWrite( T )</text><polygon fill="#A80036" points="192,148.2734,182,152.2734,192,156.2734,188,152.2734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="186" x2="394" y1="152.2734" y2="152.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="198" y="147.417">bool</text><polygon fill="#A80036" points="11,178.625,1,182.625,11,186.625,7,182.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="5" x2="170" y1="182.625" y2="182.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="17" y="177.7686">bool</text><polygon fill="#A80036" points="159,236.9766,169,240.9766,159,244.9766,163,240.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="0" x2="165" y1="240.9766" y2="240.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="7" y="236.1201">Take( CancellationToken )</text><polygon fill="#A80036" points="383,267.3281,393,271.3281,383,275.3281,387,271.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="181" x2="389" y1="271.3281" y2="271.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="188" y="266.4717">ReadAsync( CancellationToken )</text><polygon fill="#A80036" points="192,297.6797,182,301.6797,192,305.6797,188,301.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="186" x2="394" y1="301.6797" y2="301.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="198" y="296.8232">ValueTask&lt;T&gt;</text><polygon fill="#A80036" points="11,328.0313,1,332.0313,11,336.0313,7,332.0313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="5" x2="170" y1="332.0313" y2="332.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="17" y="327.1748">ValueTask&lt;T&gt;</text><polygon fill="#A80036" points="159,386.3828,169,390.3828,159,394.3828,163,390.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="0" x2="165" y1="390.3828" y2="390.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="7" y="385.5264">Dispose()</text><polygon fill="#A80036" points="383,416.7344,393,420.7344,383,424.7344,387,420.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="181" x2="389" y1="420.7344" y2="420.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="188" y="415.8779">Complete()</text><path d="M113,435.7344 L173,435.7344 L173,443.7344 L163,453.7344 L113,453.7344 L113,435.7344 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="172.7578" style="stroke: #000000; stroke-width: 2.0;" width="342.5" x="113" y="435.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="15" x="128" y="450.2295">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92" x="188" y="449.1533">[T is IDisposable]</text><path d="M123,461.0859 L196,461.0859 L196,469.0859 L186,479.0859 L123,479.0859 L123,461.0859 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="122.4063" style="stroke: #000000; stroke-width: 2.0;" width="322.5" x="123" y="461.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="138" y="475.5811">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="211" y="474.5049">[All elements stored in Channel]</text><polygon fill="#A80036" points="383,497.7891,393,501.7891,383,505.7891,387,501.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="181" x2="389" y1="501.7891" y2="501.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="188" y="496.9326">TryRead()</text><polygon fill="#A80036" points="192,528.1406,182,532.1406,192,536.1406,188,532.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="186" x2="394" y1="532.1406" y2="532.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="198" y="527.2842">T</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="181" x2="223" y1="562.4922" y2="562.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="223" x2="223" y1="562.4922" y2="575.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="182" x2="223" y1="575.4922" y2="575.4922"/><polygon fill="#A80036" points="192,571.4922,182,575.4922,192,579.4922,188,575.4922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="188" y="557.6357">T.Dispose()</text><line style="stroke: #A80036; stroke-width: 2.0;" x1="391" x2="409" y1="590.4922" y2="608.4922"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="391" x2="409" y1="608.4922" y2="590.4922"/><polygon fill="#A80036" points="11,617.4922,1,621.4922,11,625.4922,7,621.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="5" x2="175" y1="621.4922" y2="621.4922"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="167" x2="185" y1="612.4922" y2="630.4922"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="167" x2="185" y1="630.4922" y2="612.4922"/><!--MD5=[ff68d904125d44e603674c3404b0bf93]
@startuml ToolboxDataBuffer
hide footbox

participant DataBuffer <<T>>
participant Channel<<T>>

activate DataBuffer
activate Channel

[-> DataBuffer : Add( T )
DataBuffer -> Channel : TryWrite( T )
DataBuffer <- - Channel : bool
[<- DataBuffer : bool

...
[-> DataBuffer : Take( CancellationToken )
DataBuffer -> Channel : ReadAsync( CancellationToken )
DataBuffer <- - Channel : ValueTask<T>
[<- DataBuffer : ValueTask<T>

...
[-> DataBuffer : Dispose()
DataBuffer -> Channel : Complete()
alt T is IDisposable
    loop All elements stored in Channel
        DataBuffer -> Channel : TryRead()
        DataBuffer <- - Channel : T
        DataBuffer -> DataBuffer : T.Dispose()
    end
    destroy Channel
end
[<- - DataBuffer
destroy DataBuffer
@enduml

PlantUML version 1.2020.20(Sat Nov 21 11:02:45 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1250
Language: en
Country: GB
--></g></svg>